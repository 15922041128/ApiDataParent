<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.pbccrc.api.core.mapper.marketeeMapper">

	<select id="getMarketeeCount" parameterType="org.pbccrc.api.base.bean.SmsCondition" resultType="java.lang.Integer">
		select count(1) from marketee where 1=1
			<if test="province !=null and province != '' ">
            	and province = #{province}
        	</if>
			<if test="city !=null and city != '' ">
            	and city = #{city}
        	</if>
			<if test="operator !=null and operator != '' ">
            	and operator = #{operator}
        	</if>
			<if test="operator !=null and operator != '' ">
            	and operator = #{operator}
        	</if>
			<if test="age_max !=null and age_max != '' ">
            	and age < #{age_max}
        	</if>
			<if test="age_min !=null and age_min != '' ">
            	and age >= #{age_min}
        	</if>
			<if test="productType !=null and productType != '' ">
				<if test="productType =='xjd'">
	            	and xjd = 1
	        	</if>
	        	<if test="productType =='xd'">
	            	and xd = 1
	        	</if>
	        	<if test="productType =='xyk'">
	            	and xyk = 1
	        	</if>
	        	<if test="productType =='lc'">
	            	and lc = 1
	        	</if>
	        	<if test="productType =='bx'">
	            	and bx = 1
	            </if>
	        </if>
	</select>
	
	<select id="getMarketeeTelNums" parameterType="org.pbccrc.api.base.bean.SmsCondition" resultType="org.pbccrc.api.base.bean.Marketee">
		select tt.telNum from
		(select telNum, rownum from marketee where 1=1
			<if test="province !=null and province != '' ">
            	and province = #{province}
        	</if>
			<if test="city !=null and city != '' ">
            	and city = #{city}
        	</if>
			<if test="operator !=null and operator != '' ">
            	and operator = #{operator}
        	</if>
			<if test="operator !=null and operator != '' ">
            	and operator = #{operator}
        	</if>
			<if test="age_max !=null and age_max != '' ">
            	and age &lt; #{age_max}
        	</if>
			<if test="age_min !=null and age_min != '' ">
            	and age &gt;= #{age_min}
        	</if>
			<if test="productType !=null and productType != '' ">
				<if test="productType =='xjd'">
	            	and xjd = 1
	        	</if>
	        	<if test="productType =='xd'">
	            	and xd = 1
	        	</if>
	        	<if test="productType =='xyk'">
	            	and xyk = 1
	        	</if>
	        	<if test="productType =='lc'">
	            	and lc = 1
	        	</if>
	        	<if test="productType =='bx'">
	            	and bx = 1
	            </if>
	        </if>
	        and telNum is not null
	        and rowNum &lt;= #{pageSize}*#{pageNum}) tt 
	        where tt.rownum > (#{pageNum}-1)*#{pageSize}
       
	</select>
	
</mapper>